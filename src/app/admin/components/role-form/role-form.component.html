<mat-progress-bar style="position: fixed;" [mode]="progressBarMode" value="0"
    [style.visibility]="progressBarMode ? 'visible' : 'hidden'">
</mat-progress-bar>

<div fxLayout="column" fxLayoutAlign="center center">

    <form [formGroup]="roleForm" novalidate (ngSubmit)="onSubmit()" fxFlex="30"
    fxLayout="row" fxLayoutAlign="space-around center"  fxLayoutGap="10px" style="padding: 20px;">

        <mat-card class="create-event-card" fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="10px">
            <mat-toolbar color="primary" fxLayoutAlign="center center">
                <span>EDIT ROLE NAME</span>
            </mat-toolbar>

            <mat-card-content style="padding: 0px 10px 0px 10px;">
                <div fxLayout="column" fxLayoutAlign="space-between center" fxLayoutGap.gt-sm="10px">

                    <mat-form-field appearance="outline" fxFlex="48" fxFlex.xs="100">
                        <mat-label>Role Id</mat-label>
                        <input matInput placeholder="Role Id" formControlName="id" readonly/>
                    </mat-form-field>

                    <mat-form-field appearance="outline" fxFlex="48" fxFlex.xs="100">
                        <mat-label>Name</mat-label>
                        <input matInput placeholder="Name" formControlName="name" />
                        <mat-error *ngIf="roleForm.controls['name'].hasError('required')">
                            Role Name is <strong>required</strong>
                        </mat-error>
                    </mat-form-field>

                </div>
            </mat-card-content>
                    
            <mat-card-actions style="padding: 0px;">
                <button type="button" mat-flat-button color="primary" (click)="this.router.navigate(['/addUsersToRole'])">Add Users</button>
                <button type="button" mat-flat-button (click)="this.router.navigate(['/roles'])">Cancel</button>
                <button mat-flat-button color="primary" type="submit"> Save </button>
            </mat-card-actions>
        </mat-card>
    </form>

    <div class="container" fxLayout="column" fxLayoutAlign="start center">    
        <mat-toolbar style="font-size: 19px; color: var(--primary);" fxLayoutAlign="center center" display="block">
            <span>  ADD OR REMOVE USERS FROM {{roleForm.controls['name'].value}} ROLE</span>
        </mat-toolbar>
    
        <form [formGroup]="caseForm" novalidate (ngSubmit)="onSubmit()"
         style="width: 98%;" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="20px">
            <button mat-flat-button color="primary" fxFlex="10" (click)="addUserToRole()">Add</button>

            <mat-form-field fxFlex="48" fxFlex.xs="100">
                <mat-label> User</mat-label>
                <input matInput placeholder="Pick one client" formControlName="clientId" [matAutocomplete]="auto">
                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn(filteredOptions | async)">
                    <mat-option *ngFor="let client of filteredOptions | async" [value]="client.id">
                        {{client.firstName}} {{client.lastName}} ({{client.phone}})
                    </mat-option>
                </mat-autocomplete>
                <!-- <mat-error *ngIf="caseForm.controls['clientId'].hasError('required')">
                    Client is <strong>required</strong>
                </mat-error>                    
                <mat-error *ngIf="caseForm.controls['clientId'].hasError('incorrect')">
                    You have to pick a Client
                </mat-error> -->
            </mat-form-field> 
    
            <mat-form-field fxFlex="90">
                <mat-label>Filter</mat-label>
                <input matInput (keyup)="applyFilter($event)" placeholder="Ex. ium">
            </mat-form-field>
        </form>
    
        <table mat-table [dataSource]="dataSource">
        
    
          <ng-container matColumnDef="firstName">
            <th mat-header-cell *matHeaderCellDef> First Name </th>
            <td mat-cell *matCellDef="let user"> {{user.firstName}} </td>
          </ng-container>
      
    
          <ng-container matColumnDef="lastName">
            <th mat-header-cell *matHeaderCellDef> Last Name </th>
            <td mat-cell *matCellDef="let user"> {{user.lastName}} </td>
          </ng-container>
    
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef> Email </th>
            <td mat-cell *matCellDef="let user"> {{user.email}} </td>
          </ng-container>
      
          <ng-container matColumnDef="delete">
            <th mat-header-cell *matHeaderCellDef> <mat-icon>delete</mat-icon> </th>
            <td mat-cell *matCellDef="let user" style="cursor: pointer">
                <mat-icon  (click)="onDeleteUserFromRole($event, user)">delete</mat-icon>
            </td>
        </ng-container>
      
          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
</div>



  
